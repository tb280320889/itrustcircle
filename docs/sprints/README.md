# 07 迭代

迭代管理定义 iTrustCircle 项目的开发节奏、任务组织和进度控制，确保项目按计划高质量交付。

## 文档体系

### 主文档
- **[Sprint 0/1 任务卡](./sprint-0-1-cards.md)**：当前迭代的详细任务和 DoD

## 迭代策略

### Sprint 0/1：文档奠基期
**目标**：建立完整的文档架构和规范，为后续实现提供清晰指引
**原则**：WIP=1，专注文档质量，不做功能实现

#### 核心任务
- **卡 00**：记录工程健康基线
- **卡 01**：建立 docs/ 信息架构与索引
- **卡 02**：完成 PRD（MVP 文档层）
- **卡 03**：补齐三条用户旅程 A-F 骨架
- **卡 04**：建立 Failure Modes 清单
- **卡 05**：创建 ADR 索引与 8 条决策占位
- **卡 06**：建立验收文档与命令清单

### Sprint 1：核心架构期
**目标**：完成关键技术决策和核心功能实现
**重点**：Tier 1 ADR 决策 + 基础功能实现

#### 预期任务
- ADR-0002：配对机制实现
- ADR-0003：存储策略实现
- ADR-0004：数据模型实现
- Tower 基础接收功能
- Sentinel 基础守护功能

### Sprint 2：完整闭环期
**目标**：实现端到端的完整功能闭环
**重点**：Tier 2 ADR 决策 + 完整功能实现

#### 预期任务
- ADR-0005：通知通道实现
- ADR-0006：状态机实现
- ADR-0007：Contact 通知实现
- ADR-0008：幂等去重实现
- 端到端测试和优化

## 开发约束

### WIP=1 原则
- **含义**：同一时间只允许进行一张任务卡
- **目的**：确保专注度和质量，避免上下文切换
- **执行**：完成当前卡的所有 DoD 后才能开始下一卡

### 无跨层重构原则
- **含义**：一次变更只涉及一个技术层
- **目的**：降低复杂度和风险
- **执行**：跨层需求必须拆分为多张任务卡

### Capacitor 工作流强制
- **含义**：必须遵循 Web build → Cap sync → Run/Open 流程
- **目的**：确保原生功能正常工作
- **执行**：禁止手动编辑原生生成文件

### 文档驱动原则
- **含义**：所有实现必须有对应的文档支撑
- **目的**：确保实现方向正确且可追溯
- **执行**：无对应文档的需求不予实现

## 任务卡模板

每个任务卡都遵循统一结构：

```markdown
## 卡 XX：[任务标题]

### Deliverable
- 具体的交付物列表

### DoD（Definition of Done）
- 可执行的完成标准清单
- 命令和手动检查步骤

### Risks
- 潜在风险和应对策略

### How to test
- 具体的测试方法和验证步骤
```

## 进度追踪

### Sprint 0/1 进度
| 卡号 | 标题 | 状态 | 预计工时 | 实际工时 |
|------|------|------|----------|----------|
| 00 | 记录工程健康基线 | ✅ 完成 | 0.5h | 0.5h |
| 01 | 建立 docs/ 信息架构 | ✅ 完成 | 1h | 1h |
| 02 | 完成 PRD | ✅ 完成 | 2h | 2h |
| 03 | 补齐用户旅程 | ✅ 完成 | 2h | 2h |
| 04 | 建立 Failure Modes | ✅ 完成 | 1.5h | 1.5h |
| 05 | 创建 ADR 索引 | ✅ 完成 | 1h | 1h |
| 06 | 建立验收文档 | ✅ 完成 | 1h | 1h |

### 后续规划
- **Sprint 1**：预计 4 张任务卡，总计 12 工时
- **Sprint 2**：预计 6 张任务卡，总计 18 工时
- **MVP 发布**：总计约 35 工时，预计 3-4 周完成

## 质量保证

### 卡质量检查
- ✅ 每个卡都有明确的 Deliverable
- ✅ 每个卡都有可执行的 DoD
- ✅ 每个卡都有风险评估
- ✅ 每个卡都有测试方法

### 进度质量检查
- ✅ 严格遵守 WIP=1 原则
- ✅ 每个 DoD 都完整执行
- ✅ 完成后及时更新状态
- ✅ 异常情况及时记录和沟通

### 交付质量检查
- ✅ 每个 Deliverable 都完整可用
- ✅ 所有 DoD 检查都通过
- ✅ 相关文档同步更新
- ✅ 后续依赖明确标注

## 风险管理

### 技术风险
- **风险**：Capacitor 配置复杂性
- **应对**：早期原型验证，预留调试时间
- **监控**：每个卡都要验证 Capacitor 工作流

### 进度风险
- **风险**：文档工作量超出预期
- **应对**：严格 WIP=1，专注当前卡
- **监控**：每天更新进度，及时调整

### 质量风险
- **风险**：文档与实现脱节
- **应对**：文档驱动开发，实现前先确认文档
- **监控**：定期检查文档一致性

## 协作机制

### 日常协作
- **每日站会**：同步当前卡进度和阻塞
- **卡评审**：完成卡后进行质量评审
- **文档同步**：及时更新相关文档状态

### 决策机制
- **ADR 决策**：技术决策通过 ADR 流程
- **变更控制**：重大变更需要更新相关文档
- **发布决策**：基于验收结果决定发布

### 质量控制
- **DoD 检查**：每个卡完成后严格检查 DoD
- **文档审查**：重要文档需要多人审查
- **验收测试**：功能完成后执行验收测试

## 工具和流程

### 开发工具
- **代码管理**：Git 分支管理，每个卡对应一个分支
- **文档工具**：Markdown，支持链接检查和搜索
- **测试工具**：Vitest，Playwright，手动测试

### 质量工具
- **代码检查**：Prettier，ESLint，TypeScript
- **文档检查**：链接有效性，一致性检查
- **集成检查**：Capacitor 构建，Android 运行

### 协作工具
- **任务跟踪**：Markdown 任务卡，状态标签
- **文档协作**：Git 版本控制，PR 审查
- **质量监控**：自动化测试，手动检查清单

## 当前状态

### 整体进度
- **Sprint 0/1**：✅ 完成（7/7 卡）
- **文档质量**：✅ 优秀（完整性 100%，一致性 100%）
- **工程健康**：⚠️ 基本达标（需修复 lint 问题）

### 下一步计划
1. **立即**：修复 Prettier lint 问题
2. **本周**：开始 Sprint 1 任务卡设计
3. **下周**：启动 Sprint 1 开发工作
4. **月底**：完成 Sprint 1 并开始 Sprint 2