# 05 ADR（Architecture Decision Records）

ADR 记录 iTrustCircle 项目的重要架构决策，确保决策过程的透明性、可追溯性和可审查性。

## ADR 体系结构

### 决策优先级

**Tier 1 - 基础架构决策**：
- ADR-0001：客户端形态与部署边界 ✅ 已定
- ADR-0002：最小身份与配对机制
- ADR-0003：本地存储与加密策略
- ADR-0004：AlertEvent 数据模型

**Tier 2 - 核心功能决策**：
- ADR-0005：通知通道策略
- ADR-0006：Guardian 状态机
- ADR-0007：Contact 参与方式
- ADR-0008：幂等与去重策略

### ADR 模板

每个 ADR 都遵循统一结构：

```markdown
# ADR-XXXX：[决策标题]

## 状态
- 待定/已定/已废弃

## 背景
- 问题场景和上下文
- 影响范围和约束条件

## 决策
- 具体技术方案
- 实现细节和接口设计
- 代码示例（如适用）

## 影响分析
- 正向影响
- 负向影响/风险
- 对其他 ADR 的依赖

## 验证方式
- 可执行的测试步骤
- 验收标准
- Failure Modes 覆盖
```

## 决策原则

1. **文档驱动**：所有重要架构决策必须通过 ADR 记录
2. **可追溯性**：决策过程、备选方案、选择原因完整记录
3. **可验证性**：每个决策都有明确的验证方式
4. **依赖管理**：明确 ADR 间的依赖关系和优先级
5. **迭代优化**：支持决策更新和版本管理

## 使用指南

### 阅读 ADR
1. 从 [ADR 索引](./adr-index.md) 开始，了解整体决策状态
2. 根据依赖关系阅读相关 ADR
3. 关注"验证方式"部分，了解实现要求

### 创建 ADR
1. 确定 ADR 编号（按顺序分配）
2. 使用标准模板编写
3. 在索引中添加条目
4. 更新依赖关系图

### 更新 ADR
1. 标记状态变更
2. 记录变更原因
3. 更新验证方式
4. 通知相关团队

## 质量标准

每个 ADR 必须满足：
- ✅ 与 PRD 需求对应
- ✅ 与用户旅程一致
- ✅ 覆盖相关 Failure Modes
- ✅ 包含可执行的验证方式
- ✅ 明确的技术实现路径
