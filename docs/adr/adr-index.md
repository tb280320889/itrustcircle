# ADR 索引

| 编号 | 标题 | 状态 | 验证方式摘要 |
| --- | --- | --- | --- |
| ADR-0001 | 客户端形态与部署边界（Tower/Sentinel/Contact） | 已定 | 单应用多角色模式；角色切换功能；构建和运行验证通过 |
| ADR-0002 | 最小身份与配对（Tower ↔ Sentinel） | 待定 | 二维码+Token配对；配对成功可上报；Token过期和安全验证 |
| ADR-0003 | 本地存储与加密策略（队列/事件/配置） | 待定 | SQLite离线队列；加密存储敏感配置；重试策略和持久化 |
| ADR-0004 | AlertEvent 最小数据模型（Sentinel→Tower） | 待定 | JSON字段最小集合；SQLite表设计；PRD需求全覆盖 |
| ADR-0005 | 通知通道策略（MVP：Email） | 待定 | SMTP配置和发送；模板渲染；投递状态追踪 |
| ADR-0006 | Guardian 状态机（断联→倒计时→上报） | 待定 | 6状态机设计；状态转移逻辑；防抖和取消机制 |
| ADR-0007 | Contact 参与方式（无 App 的通知接收者） | 待定 | 零安装参与；多通道适配；信息内容完整性 |
| ADR-0008 | 幂等与去重策略（队列重放/塔台去重） | 待定 | 双层幂等保障；防抖机制；智能重试策略 |

## ADR 状态说明

- **已定**：决策已确定，可进入实现阶段
- **待定**：需要进一步分析和技术验证，Sprint 1 决策

## 关键依赖关系

```
ADR-0001 (已定) 
├── ADR-0002 (依赖角色模式)
├── ADR-0003 (依赖单应用架构)
└── ADR-0004 (依赖三角色交互)

ADR-0002 
├── ADR-0003 (配对信息存储)
├── ADR-0004 (sentinel_id/tower_id字段)
└── ADR-0008 (配对去重)

ADR-0003 
├── ADR-0004 (事件存储)
├── ADR-0005 (通知配置)
└── ADR-0008 (队列持久化)

ADR-0004 
├── ADR-0005 (通知内容生成)
├── ADR-0006 (事件触发)
├── ADR-0007 (Contact通知)
└── ADR-0008 (事件去重)
```

## Sprint 0/1 优先级

**已定决策**：
- ADR-0001：客户端形态（✅ 完成）

**Sprint 1 重点决策**：
- ADR-0002：配对机制（核心交互）
- ADR-0003：存储策略（可靠性基础）
- ADR-0004：数据模型（交互协议）

**Sprint 2 重点决策**：
- ADR-0005：通知通道（用户触达）
- ADR-0006：状态机（核心逻辑）
- ADR-0007：Contact参与（完整闭环）
- ADR-0008：幂等去重（稳定性）